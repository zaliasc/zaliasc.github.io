<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>webRTC技术 - zaliasc's Blog</title><meta name=Description content="This is my cool site"><meta property="og:title" content="webRTC技术"><meta property="og:description" content="WebRTC wikipedia: WebRTC (Web Real-Time Communication) is a free and open-source project providing web browsers and mobile applications with real-time communication (RTC) via application programming interfaces (APIs). It allows audio and video communication to work inside web pages by allowing direct peer-to-peer communication, eliminating the need to install plugins or download native apps. 数据包传输 一般使用 UDP 进行传输，数据"><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/webrtc%E6%8A%80%E6%9C%AF/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-11T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-11T00:00:00+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="webRTC技术"><meta name=twitter:description content="WebRTC wikipedia: WebRTC (Web Real-Time Communication) is a free and open-source project providing web browsers and mobile applications with real-time communication (RTC) via application programming interfaces (APIs). It allows audio and video communication to work inside web pages by allowing direct peer-to-peer communication, eliminating the need to install plugins or download native apps. 数据包传输 一般使用 UDP 进行传输，数据"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/webrtc%E6%8A%80%E6%9C%AF/><link rel=prev href=http://example.org/posts/%E5%87%A0%E7%A7%8D%E4%BA%92%E8%81%94%E6%80%BB%E7%BA%BF%E5%B8%A6%E5%AE%BD/><link rel=next href=http://example.org/posts/%E9%AB%98%E5%B9%B6%E5%8F%91%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E7%AC%94%E8%AE%B0/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"webRTC技术","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/webrtc%E6%8A%80%E6%9C%AF\/"},"genre":"posts","keywords":"audio","wordcount":1955,"url":"http:\/\/example.org\/posts\/webrtc%E6%8A%80%E6%9C%AF\/","datePublished":"2023-04-11T00:00:00+00:00","dateModified":"2023-04-11T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"zaliasc"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="zaliasc's Blog">Zaliasc's Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="zaliasc's Blog">Zaliasc's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">webRTC技术</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>zaliasc</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-04-11>2023-04-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1955 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#webrtc>WebRTC</a></li><li><a href=#数据包传输>数据包传输</a><ul><li><a href=#rtp-协议>RTP 协议</a></li><li><a href=#rtcp协议>RTCP协议</a></li></ul></li><li><a href=#媒体协商>媒体协商</a><ul><li><a href=#sdp协议>SDP协议</a></li><li><a href=#媒体协商过程>媒体协商过程</a></li></ul></li><li><a href=#连接建立>连接建立</a><ul><li><a href=#nat>NAT</a></li><li><a href=#turnstun-服务器>TURN/STUN 服务器</a></li></ul></li><li><a href=#数据安全性>数据安全性</a><ul><li><a href=#dtls协议>DTLS协议</a></li><li><a href=#加密协商过程>加密协商过程</a></li></ul></li><li><a href=#信令服务>信令服务</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></div><div class=content id=content><h2 id=webrtc>WebRTC</h2><p>wikipedia:</p><p><strong>WebRTC</strong> (<strong>Web Real-Time Communication</strong>) is a <a href=https://en.wikipedia.org/wiki/Free_and_open-source_software target=_blank rel="noopener noreffer">free and open-source</a> project providing <a href=https://en.wikipedia.org/wiki/Web_browser target=_blank rel="noopener noreffer">web browsers</a> and <a href=https://en.wikipedia.org/wiki/Mobile_application target=_blank rel="noopener noreffer">mobile applications</a> with <a href=https://en.wikipedia.org/wiki/Real-time_communication target=_blank rel="noopener noreffer">real-time communication</a> (RTC) via <a href=https://en.wikipedia.org/wiki/Application_programming_interface target=_blank rel="noopener noreffer">application programming interfaces</a> (APIs). It allows audio and video communication to work inside web pages by allowing direct <a href=https://en.wikipedia.org/wiki/Peer-to-peer target=_blank rel="noopener noreffer">peer-to-peer</a> communication, eliminating the need to install <a href=https://en.wikipedia.org/wiki/Plug-in_%28computing%29 target=_blank rel="noopener noreffer">plugins</a> or download native apps.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111107172.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111107172.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111107172.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111107172.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111107172.png title=image-20230711110655383></p><h2 id=数据包传输>数据包传输</h2><p>一般使用 UDP 进行传输，数据包需要进行一次封装，标识例如帧内分片号、起始结束标志等</p><h3 id=rtp-协议>RTP 协议</h3><p>g<img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101945753.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101945753.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101945753.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101945753.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101945753.png title=image-20230710194506591></p><h3 id=rtcp协议>RTCP协议</h3><p>​ 在RTP数据包的传输过程中，对于出现丢包、抖动、乱序的情况时，由 RTCP 协议进行控制。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101952801.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101952801.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101952801.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101952801.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307101952801.png title=image-20230710195212377></p><p>字段解释：TODO.</p><h2 id=媒体协商>媒体协商</h2><p>媒体协商的作用就是让双方找到<strong>共同支持的媒体能力</strong>，如双方<strong>都支持的编解码器</strong>，从而最终实现彼此之间的音视频通信。</p><h3 id=sdp协议>SDP协议</h3><p>SDP(session description protocol) 即会话控制协议，用来描述端上设备的能力，如编解码方式、传输协议、音视频格式等。在两个客户端进行通信时，首先要进行信令的交互，如SDP信息的交互。一个SDP携带的信息如下所示：</p><pre tabindex=0><code>v=0
o=- 7017624586836067756 2 IN IP4 127.0.0.1
s=-
t=0 0
// 以上表示会话描述

m=audio 9 UDP/TLS/RTP/SAVPF 111 103 104 9 0 8 106 105 13 126
...
m=video 9 UDP/TLS/RTP/SAVPF 96 97 98 99 100 101 102 122 127 121 125 107 108 109 124 120 123 119 114 115 116
...
...
a=rtpmap:111 opus/48000/2
a=rtpmap:103 ISAC/16000
a=rtpmap:104 ISAC/32000
...
</code></pre><p>当B端收到A端发送的SDP消息后，会将其支持的编码方式等与自身做对比，协商出公共的策略后返回给A端SDP信息。</p><p>SDP格式：</p><p>v=0开始表示整个session的性质：</p><ul><li><code>v=0</code> ，表示 SDP 的版本号</li><li><code>o=&lt;username> &lt;session id> &lt;version> &lt;network type> &lt;address type> &lt;address></code>表示的是对会话发起者的描述；``</li><li><code>s=&lt;session name></code>，表示一个会话</li><li><code>t=&lt;start time> &lt;stop time></code>描述了会话的开始时间和结束时间</li></ul><p>m=audio&mldr;表示一路音频流，m=video则表示视频流</p><ul><li><code>m=&lt;media> &lt;port> &lt;transport> &lt;fmt list></code>表示一个会话</li></ul><p>a=表示属性，用于进一步描述媒体信息</p><ul><li><code>a=rtpmap:&lt;payload type> &lt;encoding name>/&lt;sample rate>[/&lt;encodingparameters>]</code>表示一种编码格式</li></ul><p><strong>总结：SDP协议内容是由一个会话层和多个媒体层组成的。</strong></p><p>更多细节可以参考rfc : <a href=https://datatracker.ietf.org/doc/pdf/draft-nandakumar-rtcweb-sdp-08 target=_blank rel="noopener noreffer">https://datatracker.ietf.org/doc/pdf/draft-nandakumar-rtcweb-sdp-08</a></p><h3 id=媒体协商过程>媒体协商过程</h3><ol><li>通信双方按照SDP格式封装各自的媒体信息，如编解码器、媒体流的 SSRC、传输协议、IP 地址和端口等。</li><li>通信双方通过信令服务器交换 SDP 信息，选择共同支持的媒体能力。</li><li>开始进行通信</li></ol><p>假设通信双方分别为A和B，由A发起SDP协商，那么我们把A成为offer方，B为answer方：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102026157.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102026157.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102026157.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102026157.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102026157.png title=image-20230710202557995></p><p>双方都会存储产生或收到的SDP信息，自己的叫做Local，对方的叫做remote.</p><h2 id=连接建立>连接建立</h2><h3 id=nat>NAT</h3><p>为了解决IPV4地址不足与安全性两个主要问题，出现了NAT技术。</p><p>但是NAT技术也带来了P2P通信的困难。</p><p>NAT可以分为四类：</p><ol><li><p>锥形NAT</p><p>当 host 主机Z 通过 NAT 访问外网的 B 主机时，就会在 NAT 上打洞（建立内外网映射），所有知道这个“洞”的主机（A、C）都可以通过它与内网主机上的侦听程序通信。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102040039.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102040039.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102040039.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102040039.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102040039.png title=image-20230710204056091></p></li><li><p>IP限制性锥型NAT</p><p>只有 host 主机访问过的外网主机才能穿越 NAT</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102044513.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102044513.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102044513.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102044513.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102044513.png title=image-20230710204411606></p></li><li><p>端口限制型NAT</p><p>不光在 NAT 上对打洞的 IP 地址做了限制，而且还对具体的端口做了限制</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102046424.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102046424.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102046424.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102046424.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102046424.png title=image-20230710204615965></p></li><li><p>对称型NAT</p><p>不同的连接使用不同的NAT端口甚至连接</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102049077.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102049077.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102049077.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102049077.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102049077.png title=image-20230710204930081></p></li></ol><p>NAT类型探测有一系列的过程，如下图：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102052539.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102052539.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102052539.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102052539.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307102052539.png title=image-20230710205238402></p><p>网上有很多资料，此处不再详述。</p><p>在探测出NAT类型后，可以尝试通信。</p><p>注意：对称型 NAT 与对称型 NAT 之间以及对称型 NAT 与端口限制型 NAT 之间无法打洞成功。此处需要使用借助服务器进行互联通信。</p><h3 id=turnstun-服务器>TURN/STUN 服务器</h3><ol><li>Session Traversal Utilities for NAT (STUN) - Used to establish a direct UDP connection between two clients.</li><li>Traversal Using Relay around NAT (TURN) - Used to establish a relayed UDP or TCP connection between two clients. Here, the traffic must be relayed through the TURN server to bypass restrictive firewall rules, and the preference is UDP over TCP because TCP&rsquo;s guaranteed ordered delivery of packets implies overhead that is undesirable for real-time communications.</li><li>Secure Traversal Using Relay around NAT (TURNS) - Used to establish a relayed TCP/TLS connection between two clients. Here, the traffic must be relayed through the TURN server and through a TLS socket to bypass extremely restrictive firewall rules.</li></ol><p>简单来说：</p><ul><li>STUN服务器是用来获取外部地址的。</li><li>TURN服务器是用来在直接连接（点到点）失败的情况下进行中继数据流量的</li></ul><p>开源的TURN/STUN服务器：</p><ul><li>coturn: <a href=https://github.com/coturn/coturn target=_blank rel="noopener noreffer">https://github.com/coturn/coturn</a></li></ul><h2 id=数据安全性>数据安全性</h2><p>在数据包传输的过程中，为了保证数据的安全性和完整性，防止篡改，需要对对方的身份进行验证以及数据加密，其主要使用的协议为DTLS协议（TLS over UDP）。</p><h3 id=dtls协议>DTLS协议</h3><p>TLS协议握手过程：</p><p>ref: <a href=https://datatracker.ietf.org/doc/html/rfc5246#section-7.3 target=_blank rel="noopener noreffer">https://datatracker.ietf.org/doc/html/rfc5246#section-7.3</a></p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108629.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108629.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108629.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108629.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108629.png title=image-20230711094123459></p><p>DTLS协议握手过程：</p><p>ref: <a href=https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.4 target=_blank rel="noopener noreffer">https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.4</a></p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108770.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108770.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108770.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108770.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108770.png title=image-20230711094227571></p><h3 id=加密协商过程>加密协商过程</h3><p><img class=lazyload src=/svg/loading.min.svg data-src=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108895.png data-srcset="https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108895.png, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108895.png 1.5x, https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108895.png 2x" data-sizes=auto alt=https://hugo-github-io.oss-cn-beijing.aliyuncs.com/img/202307111108895.png title=image-20230711093907884></p><p>整个身份确认的过程可以分为几个步骤：</p><ol><li><p>通过信令服务器交换 SDP 信息，SDP 中记录了用户名、密码和指纹，用于确认身份。</p><p>eg.</p><pre tabindex=0><code>...
a=ice-ufrag:khLS
a=ice-pwd:cxLzteJaJBou3DspNaPsJhlQ
a=fingerprint:sha-256 FA:14:42:3B:C7:97:1B:E8:AE:0C2:71:03:05:05:16:8F:B9:C7:98:E9:60:43:4B:5B:2C:28:EE:5C:8F3
...
</code></pre></li><li><p>Client A 通过 STUN Server 进行认证，如果 STUN 请求中的用户名和密码与 SDP 信息中一致，说明用户客户端请求合法。</p></li><li><p>进行 DTLS 协商，交换公钥证书并协商密码相关的信息。</p></li><li><p>开始传输 SRTP 加密数据。</p></li></ol><h2 id=信令服务>信令服务</h2><p>WebRTC只描述和规定了数据平面该如何采集和传输数据，而对于如何发现对端，如何找到我要交谈的人没有做任何规定，即信令协议和机制不是由WebRTC标准定义的。</p><p>因此，我们需要自己去实现一个信令服务来在客户端之间交换信令消息和应用程序数据：</p><ul><li>作为“对端发现”的桥梁</li><li>保存 session 的状态</li></ul><p>同时，WebRTC的标准化特性使得在浏览器中运行的WebRTC应用程序与另一个通信平台运行的设备（如电话或视频会议系统）之间建立通信成为可能。</p><p>针对不同的端设备，有一些现成的信令服务器可用：</p><p>webrtc-webrtc 端：</p><ul><li>webRTC.io</li><li>easyRTC</li><li>Signalmaster</li></ul><p>webrtc-SIP 端：</p><ul><li>janus-gateway</li></ul><h2 id=reference>Reference</h2><p>[^1] <a href=https://michaelyou.github.io/2018/08/01/%E7%9C%9F%E5%AE%9E%E4%B8%96%E7%95%8C%E4%B8%AD%E7%9A%84WebRTC/ target=_blank rel="noopener noreffer">真实世界中的WebRTC</a></p><p>[^2] <a href=https://developer.liveswitch.io/liveswitch-server/guides/what-are-stun-turn-and-ice.html target=_blank rel="noopener noreffer">What Are STUN, TURN, and ICE?</a></p><p>[^3] <a href=https://github.com/coturn/coturn target=_blank rel="noopener noreffer">coturn</a></p><p>[^4] <a href=https://time.geekbang.org/column/article/107916 target=_blank rel="noopener noreffer">从0打造音视频直播系统</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-04-11</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/audio/>audio</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/%E5%87%A0%E7%A7%8D%E4%BA%92%E8%81%94%E6%80%BB%E7%BA%BF%E5%B8%A6%E5%AE%BD/ class=prev rel=prev title=几种互联总线带宽：PCIe、QPI、UPI、NVLink><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>几种互联总线带宽：PCIe、QPI、UPI、NVLink</a>
<a href=/posts/%E9%AB%98%E5%B9%B6%E5%8F%91%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E7%AC%94%E8%AE%B0/ class=next rel=next title=高并发系统设计学习笔记>高并发系统设计学习笔记<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=gitalk class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://github.com/gitalk/gitalk></a>Gitalk</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2021 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>zaliasc</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:30},comment:{gitalk:{admin:["zaliasc"],clientID:"e99cee6375457176da1b",clientSecret:"4563c1275949c3aad80b1982b754356220a16fe1",id:"2023-04-11T00:00:00Z",owner:"zaliasc",repo:"hugo-repo-comment",title:"webRTC技术"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>